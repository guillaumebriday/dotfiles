# Global functions
path () {
  echo $PATH | tr ':' '\n'
}

# Example: port 3000
port () {
  lsof -i"TCP:$1" -sTCP:LISTEN -n -P
}

# Git functions
clone () {
  basename=$(basename $1 .git)

  git clone $1 && cd $basename
}

# Clean merged branches
sweep () {
  git branch --merged "$(git_main_branch)" | grep -v "$(git_main_branch)$" | xargs git branch -d && git remote prune origin
}

prepare_rails () {
  cd . # Change Node and Ruby version if needed

  echo 'Installing dependencies...'
  bundle install --quiet

  if [ -f package.json ]; then
    yarn install --silent --non-interactive --ignore-engines
  fi

  echo 'Removing assets & cache...'
  rm -rf public/assets tmp/cache 2> /dev/null
}
